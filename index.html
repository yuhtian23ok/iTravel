<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 åå¤å±‹ãƒ»åŒ—é™¸ æ…¢æ´»ä¹‹æ—…</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Google Fonts (Noto Sans TC) -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <style>
        /* Custom Styles & Overrides */
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #F9FAFB; /* Warm neutral background */
            color: #374151;
        }

        /* Chart Container Styling - Mandatory Requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Hide scrollbar for horizontal scrolling elements but keep functionality */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Timeline Connector Line */
        .timeline-line {
            position: absolute;
            left: 1.25rem; /* Matches pl-5 center */
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #E5E7EB;
            z-index: 0;
        }

        /* Active Tab Styling */
        .tab-active {
            border-bottom: 2px solid #0F766E; /* Teal-700 */
            color: #0F766E;
            font-weight: 600;
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals with Teal/Mountain Green Accents. 
         Background: Gray-50. Text: Gray-700. Accents: Teal-700/Amber-600.
         Reasoning: Creates a calm, "Slow Travel" vibe suitable for seniors. -->

    <!-- Application Structure Plan: 
         1. Hero Section: Quick summary of dates, travelers, and countdown.
         2. Sticky Navigation: Fast access to Itinerary, Transport, Food, Budget, Tips.
         3. Interactive Route Map (CSS-based): A visual flow of the loop trip.
         4. Daily Itinerary (Timeline): The core content. Detailed cards with toggle functionality.
         5. Transport & Budget Analysis: Chart.js visualizations to justify the Pass choice.
         6. Food Guide: Filterable grid of recommended spots.
         7. Expert Q&A: Addressing the user's specific questions about Kamikochi/Nara. -->
    
    <!-- Visualization & Content Choices:
         1. Route Visualization -> Goal: Context -> Method: CSS Flexbox Flowchart -> Interaction: None -> Justification: Simple visual reinforcement of the geographical loop.
         2. Daily Itinerary -> Goal: Guide -> Method: Vertical Timeline Cards -> Interaction: Expand/Collapse details -> Justification: Prevents information overload.
         3. Budget Breakdown -> Goal: Inform -> Method: Chart.js Doughnut -> Interaction: Tooltip hover -> Justification: Visualizes the 60k TWD distribution.
         4. Transport Comparison -> Goal: Compare -> Method: Chart.js Bar Chart -> Interaction: None -> Justification: Proves value of the JR Pass.
         5. Food Map -> Goal: Explore -> Method: Grid cards with JS Filter -> Interaction: Filter by cuisine -> Justification: Helps find food based on current craving. 
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="flex flex-col min-h-screen">

    <!-- Header / Hero -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <span class="text-xl font-bold text-teal-800">ğŸ”ï¸ ä¸­éƒ¨åŒ—é™¸ãƒ»æ…¢æ´»è¡Œ</span>
                </div>
                <!-- Desktop Nav -->
                <nav class="hidden md:flex space-x-8">
                    <button onclick="switchTab('itinerary')" class="nav-btn tab-active px-3 py-2 text-sm font-medium">è¡Œç¨‹è¦åŠƒ</button>
                    <button onclick="switchTab('transport')" class="nav-btn text-gray-500 hover:text-gray-700 px-3 py-2 text-sm font-medium">æ—…è²»è¨˜å¸³</button>
                    <button onclick="switchTab('food')" class="nav-btn text-gray-500 hover:text-gray-700 px-3 py-2 text-sm font-medium">ç¾é£Ÿåœ°åœ–</button>
                    <button onclick="switchTab('budget')" class="nav-btn text-gray-500 hover:text-gray-700 px-3 py-2 text-sm font-medium">é ç®—åˆ†æ</button>
                    <button onclick="switchTab('tips')" class="nav-btn text-gray-500 hover:text-gray-700 px-3 py-2 text-sm font-medium">è¡Œå‰é ˆçŸ¥ & Q&A</button>
                </nav>
                <!-- Mobile Menu Button (Simple logic for demo) -->
                <div class="md:hidden flex items-center">
                    <button id="mobile-menu-btn" class="text-gray-500 hover:text-gray-700 focus:outline-none">
                        <span class="text-2xl">â˜°</span>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Nav Panel -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-100">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <button onclick="switchTab('itinerary')" class="block w-full text-left px-3 py-2 text-base font-medium text-teal-700 bg-gray-50">è¡Œç¨‹è¦åŠƒ</button>
                <button onclick="switchTab('transport')" class="block w-full text-left px-3 py-2 text-base font-medium text-gray-600 hover:bg-gray-50">æ—…è²»è¨˜å¸³</button>
                <button onclick="switchTab('food')" class="block w-full text-left px-3 py-2 text-base font-medium text-gray-600 hover:bg-gray-50">ç¾é£Ÿåœ°åœ–</button>
                <button onclick="switchTab('budget')" class="block w-full text-left px-3 py-2 text-base font-medium text-gray-600 hover:bg-gray-50">é ç®—åˆ†æ</button>
                <button onclick="switchTab('tips')" class="block w-full text-left px-3 py-2 text-base font-medium text-gray-600 hover:bg-gray-50">è¡Œå‰é ˆçŸ¥ & Q&A</button>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">

        <!-- Trip Overview Card -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-100 p-6 mb-8">
            <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-2">2026 åå¤å±‹ã€é«˜å±±ã€ç«‹å±±é»‘éƒ¨ 7æ—¥éŠ</h1>
            <p class="text-gray-600 mb-4">æ—¥æœŸï¼š2026/5/24 (æ—¥) - 2026/5/30 (å…­) | äººæ•¸ï¼š3äºº</p>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                <div class="bg-orange-50 p-3 rounded-lg">
                    <div class="text-xs text-orange-600 font-semibold uppercase">é¢¨æ ¼</div>
                    <div class="text-lg font-bold text-gray-700">æ‚ é–’æ…¢æ´»</div>
                </div>
                <div class="bg-teal-50 p-3 rounded-lg">
                    <div class="text-xs text-teal-600 font-semibold uppercase">é‡é»</div>
                    <div class="text-lg font-bold text-gray-700">ç«‹å±±é»‘éƒ¨</div>
                </div>
                <div class="bg-blue-50 p-3 rounded-lg">
                    <div class="text-xs text-blue-600 font-semibold uppercase">äº¤é€š</div>
                    <div class="text-lg font-bold text-gray-700">JRå‘¨éŠåˆ¸</div>
                </div>
                <div class="bg-purple-50 p-3 rounded-lg">
                    <div class="text-xs text-purple-600 font-semibold uppercase">é ç®—</div>
                    <div class="text-lg font-bold text-gray-700">6è¬/äºº</div>
                </div>
            </div>
        </div>

        <!-- Section: Itinerary (Default Visible) -->
        <section id="itinerary" class="tab-content block animate-fade-in">
            <div class="mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-2 border-l-4 border-teal-600 pl-3">æ¯æ—¥è¡Œç¨‹ç¸½è¦½</h2>
                <p class="text-gray-600 text-sm mb-4">é»æ“Šå¡ç‰‡å¯æŸ¥çœ‹è©³ç´°çš„æ™‚é–“å®‰æ’èˆ‡äº¤é€šè³‡è¨Šã€‚æ‰€æœ‰åœ°é»çš†å·²é€£çµè‡³ Google Mapsã€‚</p>
                
                <!-- Timeline Container -->
                <div class="relative space-y-8 pl-4 md:pl-0" id="timeline-container">
                    <!-- Timeline items will be injected by JS -->
                </div>
            </div>
        </section>

        <!-- Section: Transport -->
        <section id="transport" class="tab-content hidden animate-fade-in">
            <div class="flex justify-between items-end mb-4 border-l-4 border-blue-600 pl-3">
                <h2 class="text-xl font-bold text-gray-800">å³æ™‚æ—…è²»è¨˜å¸³</h2>
                <div id="top-total-twd" class="text-xl font-black text-teal-700">NT$ 0</div>
            </div>
            <div class="bg-white rounded-3xl p-6 shadow-sm mb-8 border border-gray-100">
                <div class="flex gap-2 mb-4">
                    <select id="add-day" class="flex-1 bg-gray-50 border border-gray-200 p-3 rounded-2xl text-sm outline-none">
                        <option value="1">Day 1</option><option value="2">Day 2</option><option value="3">Day 3</option><option value="4">Day 4</option>
                        <option value="5">Day 5</option><option value="6">Day 6</option><option value="7">Day 7</option><option value="8">Day 8</option>
                    </select>
                    <select id="add-cat" class="flex-1 bg-gray-50 border border-gray-200 p-3 rounded-2xl text-sm outline-none">
                        <option value="ğŸ±">ğŸ± é¤é£²</option><option value="ğŸš†">ğŸš† äº¤é€š</option><option value="ğŸ›ï¸">ğŸ›ï¸ è³¼ç‰©</option><option value="ğŸ¨">ğŸ¨ ä½å®¿</option><option value="ğŸŸï¸">ğŸŸï¸ é–€ç¥¨</option>
                    </select>
                </div>
                <input type="text" id="add-item" placeholder="å“é …åç¨±" class="w-full bg-gray-50 border border-gray-200 p-4 rounded-2xl mb-4 outline-none focus:border-teal-500">
                <div class="flex gap-3">
                    <input type="number" id="add-jpy" placeholder="æ—¥å¹£é‡‘é¡" class="flex-[2] bg-teal-50 border border-teal-100 p-4 rounded-2xl font-bold text-teal-700 text-lg outline-none">
                    <button onclick="handleCreate()" class="flex-1 bg-teal-700 text-white font-bold rounded-2xl shadow-lg tap-active">æ–°å¢</button>
                </div>
            </div>
            <div id="render-target" class="space-y-6"></div>
        </section>

        <!-- Section: Food Map -->
        <section id="food" class="tab-content hidden animate-fade-in">
            <div class="mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-2 border-l-4 border-orange-500 pl-3">ä¸­éƒ¨ç¾é£Ÿåœ°åœ–</h2>
                <p class="text-gray-600 mb-4">åå¤å±‹çš„é°»é­šé£¯ã€é«˜å±±çš„é£›é©’ç‰›ã€å¯Œå±±çš„ç™½è¦ã€‚è«‹é»æ“ŠæŒ‰éˆ•ç¯©é¸æ‚¨æƒ³åƒçš„ç¾é£Ÿã€‚</p>
                
                <!-- Filters -->
                <div class="flex flex-wrap gap-2 mb-6" id="food-filters">
                    <button onclick="filterFood('all')" class="food-filter-btn bg-gray-800 text-white px-3 py-1 rounded-full text-sm">å…¨éƒ¨é¡¯ç¤º</button>
                    <button onclick="filterFood('nagoya')" class="food-filter-btn bg-white border border-gray-300 text-gray-600 px-3 py-1 rounded-full text-sm hover:bg-gray-100">åå¤å±‹åç‰©</button>
                    <button onclick="filterFood('hida')" class="food-filter-btn bg-white border border-gray-300 text-gray-600 px-3 py-1 rounded-full text-sm hover:bg-gray-100">é£›é©’ç‰›/é«˜å±±</button>
                    <button onclick="filterFood('toyama')" class="food-filter-btn bg-white border border-gray-300 text-gray-600 px-3 py-1 rounded-full text-sm hover:bg-gray-100">å¯Œå±±æµ·é®®</button>
                    <button onclick="filterFood('dessert')" class="food-filter-btn bg-white border border-gray-300 text-gray-600 px-3 py-1 rounded-full text-sm hover:bg-gray-100">ç”œé»/å–«èŒ¶</button>
                </div>

                <!-- Food Grid -->
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="food-grid">
                    <!-- Food items injected by JS -->
                </div>
            </div>
        </section>

        <!-- Section: Budget -->
        <section id="budget" class="tab-content hidden animate-fade-in">
            <div class="mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-2 border-l-4 border-purple-600 pl-3">é ç®—è¦åŠƒ (æ¯äºº)</h2>
                <p class="text-gray-600 mb-6">ç›®æ¨™é ç®—ï¼š60,000 TWDã€‚ç›®å‰çš„è¦åŠƒåœ¨é ç®—ç¯„åœå…§ï¼Œä¿ç•™äº†è³¼ç‰©èˆ‡äº«ç”¨ç¾é£Ÿçš„å½ˆæ€§ã€‚</p>
                
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div class="chart-container">
                        <canvas id="budgetChart"></canvas>
                    </div>
                    <div class="space-y-4">
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <div class="flex justify-between items-center mb-1">
                                <span class="font-bold text-gray-700">æ©Ÿç¥¨ (CI 154/155)</span>
                                <span class="font-bold text-purple-600">15,000 TWD</span>
                            </div>
                            <div class="text-xs text-gray-500">é ä¼°åƒ¹æ ¼ï¼Œå«ç¨…èˆ‡è¡Œæã€‚</div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <div class="flex justify-between items-center mb-1">
                                <span class="font-bold text-gray-700">ä½å®¿ (6æ™š)</span>
                                <span class="font-bold text-purple-600">15,000 TWD</span>
                            </div>
                            <div class="text-xs text-gray-500">å¹³å‡ 3,000/æ™š/äººã€‚é¸æ“‡è»Šç«™é™„è¿‘èˆ’é©å•†å‹™é£¯åº—ã€‚</div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <div class="flex justify-between items-center mb-1">
                                <span class="font-bold text-gray-700">äº¤é€š</span>
                                <span class="font-bold text-purple-600">8,000 TWD</span>
                            </div>
                            <div class="text-xs text-gray-500">ç«è»Š/å·´å£«/åœ°éµè²»ç”¨ã€‚</div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <div class="flex justify-between items-center mb-1">
                                <span class="font-bold text-gray-700">é¤é£²èˆ‡è¶…å¸‚</span>
                                <span class="font-bold text-purple-600">14,000 TWD</span>
                            </div>
                            <div class="text-xs text-gray-500">æ¯æ—¥ç´„ 2,000 TWDã€‚</div>
                        </div>
                        <div class="pt-2 border-t border-gray-300 flex justify-between items-center">
                            <span class="text-lg font-bold text-gray-900">ç¸½è¨ˆé ä¼°</span>
                            <span class="text-xl font-bold text-teal-700">52,000 TWD</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section: Tips & Q&A -->
        <section id="tips" class="tab-content hidden animate-fade-in">
            <div class="mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-2 border-l-4 border-yellow-500 pl-3">è¡Œå‰æº–å‚™èˆ‡å°ˆå®¶å»ºè­°</h2>
                
                <div class="space-y-6">
                    <!-- Q1 -->
                    <div class="bg-yellow-50 rounded-xl p-6 border border-yellow-100">
                        <h3 class="font-bold text-gray-800 mb-2">Q: å¿…å»ç«‹å±±é»‘éƒ¨ï¼Œæƒ³çŸ¥é“ä¸Šé«˜åœ°èˆ‡ç©—é«˜æ˜¯å¦åŒè³ªæ€§é«˜ï¼Ÿé †è·¯å—ï¼Ÿ</h3>
                        <div class="text-sm text-gray-700 space-y-2">
                            <p><strong>A: å»ºè­°ä¸‹æ¬¡å†å®‰æ’ä¸Šé«˜åœ°ã€‚</strong></p>
                            <ul class="list-disc pl-5 space-y-1">
                                <li><strong>åŒè³ªæ€§ï¼š</strong>å…©è€…éƒ½æ˜¯ã€Œå±±å²³ç¾æ™¯ã€ï¼Œä½†é«”é©—ä¸åŒã€‚ç«‹å±±é»‘éƒ¨é‡åœ¨ã€Œæ­ä¹˜å¤šç¨®äº¤é€šå·¥å…·ç¿»å±±è¶Šå¶ºã€èˆ‡ã€Œé›ªç‰†å£¯è§€ã€ï¼›ä¸Šé«˜åœ°å‰‡é‡åœ¨ã€Œå¹³åœ°å¥è¡Œã€èˆ‡ã€Œæ²³ç«¥æ©‹å±±æ°´å€’å½±ã€ã€‚å°æ–¼é•·è¼©ä¾†èªªï¼Œ8å¤©å…§è¦å¡å…¥é€™å…©å€‹é»æœƒéå¸¸ç´¯ã€‚</li>
                                <li><strong>é †è·¯æ€§ï¼š</strong>é›–ç„¶ä¸Šé«˜åœ°åœ¨æ¾æœ¬åˆ°é«˜å±±çš„é€”ä¸­ï¼Œä½†ç‚ºäº†ä¿æŒã€Œæ‚ é–’ã€çš„æ­¥èª¿ï¼Œè‹¥å¼·è¡ŒåŠ å…¥ï¼ŒDay 7 æœƒè®Šæˆæ•´å¤©éƒ½åœ¨è¶•è·¯èˆ‡èµ°è·¯ï¼Œç„¡æ³•äº«å—æ¾æœ¬å¸‚å€çš„æ„œæ„ã€‚</li>
                                <li><strong>çµè«–ï¼š</strong>é€™æ¬¡å°ˆæ³¨æ–¼ç«‹å±±é»‘éƒ¨çš„å¤§å±±å¤§æ°´ï¼Œä¸Šé«˜åœ°ç•™çµ¦æœªä¾†çš„ã€Œé•·é‡æ·±åº¦éŠã€ã€‚</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Q2 -->
                    <div class="bg-yellow-50 rounded-xl p-6 border border-yellow-100">
                        <h3 class="font-bold text-gray-800 mb-2">Q: å¥ˆè‰¯äº•å®¿ vs é¦¬ç± å®¿/å¦»ç± å®¿ï¼Œæ¨è–¦å“ªå€‹ï¼Ÿ</h3>
                        <div class="text-sm text-gray-700 space-y-2">
                            <p><strong>A: æ¨è–¦é¦¬ç± å®¿/å¦»ç± å®¿ã€‚</strong></p>
                            <ul class="list-disc pl-5 space-y-1">
                                <li><strong>åœ°ç†ä½ç½®ï¼š</strong>æ‚¨æåˆ° Day 2 è¡Œç¨‹ï¼Œå¾åå¤å±‹å‡ºç™¼ï¼Œé¦¬ç± å®¿/å¦»ç± å®¿ä½æ–¼ä¸­æ´¥å·æ–¹å‘ï¼Œäº¤é€šè¼ƒç‚ºç›´è¦ºï¼Œæ˜¯ä¸€æ—¥éŠçš„ç¶“å…¸è·¯ç·šã€‚å¥ˆè‰¯äº•å®¿ä½æ–¼æ¾æœ¬é™„è¿‘ï¼Œè‹¥è¦å®‰æ’æ‡‰æ”¾åœ¨ Day 7ï¼Œä½† Day 7 å·²ç¶“æœ‰æ¾æœ¬è¡Œç¨‹ã€‚</li>
                                <li><strong>è§€å…‰é«”é©—ï¼š</strong>é¦¬ç± å®¿çš„åœ°å½¢ç‚ºçŸ³æ¿å¡é“ï¼Œéå¸¸æœ‰ç‰¹è‰²ä¸”ç†±é¬§ï¼›å¦»ç± å®¿å‰‡ä¿å­˜äº†æ›´åŸå§‹çš„æ±Ÿæˆ¶é¢¨æƒ…ã€‚å…©è€…ä¹‹é–“çš„é€£æ¥å°æ–¼é•·è¼©å¯èƒ½éœ€è¦æ­å·´å£«ï¼Œä½†æ•´é«”è§€å…‰é…å¥—è¼ƒå®Œå–„ã€‚</li>
                                <li><strong>åˆ¥æ“”å¿ƒèª¤æœƒï¼š</strong>æ‚¨æåˆ°çš„ã€Œå¥ˆè‰¯æ™¯å®¿ã€å¯èƒ½æ˜¯æŒ‡ã€Œå¥ˆè‰¯äº•å®¿ (Narai-juku)ã€ã€‚å¦‚æœæ˜¯æŒ‡é—œè¥¿çš„å¥ˆè‰¯ (Nara)ï¼Œå‰‡å®Œå…¨åæ–¹å‘ï¼Œçµ•å°ä¸å»ºè­°ã€‚</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Checklist -->
                    <div class="bg-white rounded-xl p-6 border border-gray-200">
                        <h3 class="font-bold text-gray-800 mb-3">ğŸ§³ è¡Œå‰æª¢æŸ¥æ¸…å–®</h3>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <label class="flex items-center space-x-2"><input type="checkbox" class="form-checkbox text-teal-600"> <span>è­·ç…§ (æœ‰æ•ˆæœŸ6å€‹æœˆä»¥ä¸Š)</span></label>
                            <label class="flex items-center space-x-2"><input type="checkbox" class="form-checkbox text-teal-600"> <span>Visit Japan Web å¡«å¯«</span></label>
                            <label class="flex items-center space-x-2"><input type="checkbox" class="form-checkbox text-teal-600"> <span>è³¼è²·/é ç´„ JR å‘¨éŠåˆ¸</span></label>
                            <label class="flex items-center space-x-2"><input type="checkbox" class="form-checkbox text-teal-600"> <span>ç«‹å±±é»‘éƒ¨é–‹å±±æ™‚é–“é ç´„</span></label>
                            <label class="flex items-center space-x-2"><input type="checkbox" class="form-checkbox text-teal-600"> <span>é•·è¼©è—¥å“/ä¿æš–è¡£ç‰©</span></label>
                            <label class="flex items-center space-x-2"><input type="checkbox" class="form-checkbox text-teal-600"> <span>å¢¨é¡ (é›ªåœ°åå…‰å¼·çƒˆ)</span></label>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <div id="modal-edit" class="hidden fixed inset-0 z-[60] modal-overlay flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-sm rounded-[2.5rem] p-8 shadow-2xl">
            <h2 class="text-xl font-black mb-6 text-gray-800">ä¿®æ”¹æ˜ç´°</h2>
            <div class="space-y-4">
                <input type="text" id="edit-item" class="w-full border border-gray-200 p-4 rounded-2xl bg-gray-50 outline-none">
                <div class="grid grid-cols-2 gap-3">
                    <input type="number" id="edit-jpy" placeholder="æ—¥å¹£" class="w-full border border-gray-200 p-4 rounded-2xl font-bold text-teal-700">
                    <input type="number" id="edit-twd" placeholder="å°å¹£" class="w-full border-2 border-teal-100 p-4 rounded-2xl font-bold text-blue-700 bg-blue-50">
                </div>
            </div>
            <div class="mt-8 flex flex-col gap-2">
                <button onclick="saveChanges()" class="w-full py-4 bg-teal-800 text-white font-bold rounded-2xl">å„²å­˜ä¿®æ”¹</button>
                <div class="flex gap-2">
                    <button onclick="showDeleteConfirm()" class="flex-1 py-4 text-red-500 font-bold">ğŸ—‘ï¸ åˆªé™¤</button>
                    <button onclick="closeModals()" class="flex-1 py-4 text-gray-400">é—œé–‰</button>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-delete" class="hidden fixed inset-0 z-[70] modal-overlay flex items-center justify-center p-6">
        <div class="bg-white w-full max-w-xs rounded-[2rem] p-8 shadow-2xl text-center">
            <h3 class="text-lg font-black mb-6">ç¢ºå®šåˆªé™¤å—ï¼Ÿ</h3>
            <div class="flex gap-3">
                <button onclick="hideDeleteConfirm()" class="flex-1 py-3 bg-gray-100 text-gray-500 rounded-xl">å–æ¶ˆ</button>
                <button onclick="executeDelete()" class="flex-1 py-3 bg-red-600 text-white rounded-xl">åˆªé™¤</button>
            </div>
        </div>
    </div>
    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-300 py-6 mt-auto">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-sm">Created for 2026 Central Japan Trip.</p>
            <p class="text-xs mt-2 text-gray-500">æ­¤è¡Œç¨‹ç‚ºè¦åŠƒå»ºè­°ï¼Œå¯¦éš›æ™‚é–“è«‹ä»¥ç•¶åœ°äº¤é€šç‹€æ³ç‚ºæº–ã€‚</p>
        </div>
    </footer>

    <script>
        // --- Data Definitions ---

        const itineraryData = [
            {
                day: 1,
                date: "5/24 (æ—¥)",
                title: "æŠµé”åå¤å±‹ï¼Œå¸‚å€æ¼«æ­¥",
                sunset: "18:56",
                stay: "åå¤å±‹è»Šç«™å‘¨é‚Š (åéµæ ¼è˜­é£¯åº— åé‰„ã‚°ãƒ©ãƒ³ãƒ‰ãƒ›ãƒ†ãƒ«è»Šç«™)",
                highlights: ["ä¸­éƒ¨åœ‹éš›æ©Ÿå ´", "åéµç™¾è²¨", "ä¸–ç•Œã®å±±ã¡ã‚ƒã‚“"],
                timeline: [
                    { time: "05:40", action: "å®¶è£¡åŒ…è»Šå‡ºç™¼~~", type: "home", note: "é è¨ˆæ—©ä¸Š 06:00 åˆ°é”æ¡ƒåœ’æ©Ÿå ´" },
                    { time: "07:30", action: "CI 154 é›¢é–‹æ¡ƒåœ’åœ‹éš›æ©Ÿå ´", type: "flight" },
                    { time: "11:20", action: "CI 154 æŠµé”ä¸­éƒ¨åœ‹éš›æ©Ÿå ´", type: "flight", note: "1. è¾¦ç†å…¥å¢ƒ<br>2. é ˜JRå‘¨éŠåˆ¸<br>â€¢ åŠƒä½ é£›é©’ç‰¹æ€¥åˆ—è»Šã€åå¤å±‹è»Šç«™ â¡ é«˜å±±è»Šç«™ã€‘ï¼šå³å´ä½ç½®<br>â€¢ åŠƒä½ é£›é©’ç‰¹æ€¥åˆ—è»Šã€é«˜å±±è»Šç«™ â¡ å¯Œå±±è»Šç«™ã€‘ï¼šå·¦å´ä½ç½®<br>3. [å¯é¸]<br>â€¢ å¯è€ƒæ…®åœ¨ç¬¬1èˆªå»ˆå…ˆåƒé»æ±è¥¿<br>â€¢ è²·è¦ä»™è²ä¹‹é‡Œç•¶é›¶é£Ÿã€è²·æ°´æœä¸‰æ˜æ²»<br>4. æ­ä¹˜åéµ Î¼-SKY å‰å¾€åå¤å±‹ç«™ (ç´„28åˆ†)" },
                    { time: "14:00", action: "(å¾…ç¢ºèª)é£¯åº— Check-in & è³¼è²·æš–æš–åŒ…", type: "hotel", note: "â€¢ åéµæ ¼è˜­é£¯åº— åé‰„ã‚°ãƒ©ãƒ³ãƒ‰ãƒ›ãƒ†ãƒ«è»Šç«™<br>â€¢ é™„è¿‘è—¥å¦åº— (Matsukiyo) æ¡è³¼ä¿æš–ç”¨å“ï¼Œä¸é5/11çš„é«˜å±±ä¸Šä¹Ÿæœ‰è—¥å¦åº—" },
                    { time: "18:00", action: "(å¾…ç¢ºèª)æ™šé¤ï¼šä¸–ç•Œã®å±±ã¡ã‚ƒã‚“ æ‰‹ç¾½å…ˆ", type: "food", link: "https://www.google.com/maps/search/?api=1&query=Sekai+no+Yamachan+Nagoya" },
                    { time: "20:00", action: "å®¿ï¼šåéµæ ¼è˜­é£¯åº— åé‰„ã‚°ãƒ©ãƒ³ãƒ‰ãƒ›ãƒ†ãƒ«è»Šç«™", type: "rest", link: "https://www.google.com/maps/place/%E5%90%8D%E9%90%B5%E6%A0%BC%E8%98%AD%E9%A3%AF%E5%BA%97/@35.1684574,136.8818141,17z/data=!3m1!5s0x600376dde7215eeb:0x922749aab9beaa4d!4m10!3m9!1s0x600376dde144a0f7:0xb5a6a966b1810e48!5m3!1s2026-05-13!4m1!1i2!8m2!3d35.168453!4d136.884389!16s%2Fg%2F1tdy_x3y?entry=ttu&g_ep=EgoyMDI2MDEwNi4wIKXMDSoASAFQAw%3D%3D", note: "ç‚ºæ˜å¤©è¡Œç¨‹å„²å‚™é«”åŠ›" },
                    { time: "24:00", action: "å¤§è¡Œæç®±å°‡å­˜æ”¾åœ¨é£¯åº—ï¼Œç­‰ç¬¬6å¤©å›åå¤å±‹æœƒä½å®¿åŒä¸€é–“é£¯åº—", type: "rest", note: "ä¹‹å¾Œè¡Œç¨‹è¼•è£ä¸Šè·¯~" }
                ]
            },           
            {
                day: 2,
                date: "5/25 (ä¸€)",
                title: "æ­ä¹˜é£›é©’è™Ÿï¼Œå‰é€²é«˜å±±",
                sunset: "19:00",
                stay: "é«˜å±±ç«™å‘¨é‚Š (Mukuri-an ç„¡å¢é‡Œåºµ)",
                highlights: ["é£›é©’ç‰¹æ€¥é¢¨æ™¯", "é«˜å±±è€è¡—", "é£›é©’ç‰›"],
                note: "â˜…å•Ÿç”¨ JR å‘¨éŠåˆ¸ Day 1",
                timeline: [
                    { time: "08:37", action: "æ­ä¹˜ Hida 3 è™Ÿ (é£›é©’è™Ÿ)", type: "train", note: "æ¬£è³æ²¿é€”æºªè°·ç¾æ™¯ï¼Œç´„ 2.5 å°æ™‚" },
                    { time: "10:58", action: "æŠµé”é«˜å±±ï¼Œé£¯åº—å¯„æ”¾è¡Œæ", type: "hotel", link: "https://www.google.com/maps/place/Mukuri-an/@36.1412688,137.256591,17.25z/data=!4m11!3m10!1s0x6002bb0ac25d0a81:0xff515f43f33e068b!5m4!1s2026-05-11!2i2!4m1!1i2!8m2!3d36.1417352!4d137.2561679!16s%2Fg%2F11frdhfm_q?authuser=0&entry=ttu&g_ep=EgoyMDI2MDEwNy4wIKXMDSoASAFQAw%3D%3D", note: "å®¿ï¼šMukuri-an ç„¡å¢é‡Œåºµ (æ•´æ£Ÿå¼æ°‘å®¿ï¼Œæ²’æœ‰é™„é¤)"  },
                    { time: "11:30", action: "é«˜å±± æ•£ç­–", type: "walk", note: "é«˜å±±æ˜Ÿå·´å…‹ æ¼†å™¨æœ¨æ¯<br>å®®å·æœå¸‚<br>â€¢ ãƒã‚¢ ãƒ‰ ã‚³ã‚³ (é«˜å±±å¸ƒä¸)<br>â€¢ é£›é©’ç‰›å¥¶<br>â€¢ é«˜å±±æ—ç››å ‚ (ãŠã‚ã‚‰ç‰å¤© è›‹ç‡’)<br>â€¢ ç³€å±‹æŸ´ç”°æ˜¥æ¬¡å•†åº— (å‘³å™Œ)<br>è€è¡— (ä¸‰ç”ºç­‹)<br>â€¢ äºŒå››ä¸‰å±‹(çƒ¤é†¬æ²¹åœ˜å­)<br>â€¢ å“åšé£›é©’ç‰›å£½å¸<br>â€¢ æ¸…é…’è©¦é£²<br> æ«»å±±å…«å¹¡å®®" },
                    { time: "17:00", action: "æ™šé¤ï¼šSuzuya Restaurant å¯¿ã€…ã‚„", type: "food", link: "https://www.google.com/maps/place/Suzuya+Restaurant/@36.140195,137.2548918,17.25z/data=!4m6!3m5!1s0x6002bad777c1deb5:0x8eb9650f7fc1e916!8m2!3d36.1424136!4d137.2556933!16s%2Fg%2F1tdbkxmk?authuser=0&entry=ttu&g_ep=EgoyMDI2MDEwNi4wIKXMDSoASAFQAw%3D%3D", note: "å‹™å¿…æå‰é ç´„" },
                    { time: "20:00", action: "å®¿ï¼šMukuri-an ç„¡å¢é‡Œåºµ", type: "rest", link: "https://www.mukurian.jp/index.html", note: "æ•´æ£Ÿå¼æ°‘å®¿ï¼Œæ²’æœ‰é™„é¤" }
                ]
            },
            {
                day: 3,
                date: "5/26 (äºŒ)",
                title: "ç«¥è©±ä¸–ç•ŒåˆæŒæ‘",
                sunset: "19:00",
                stay: "ç™½å·é„‰ (å¾¡å®¿ çµä¹‹èŠ å¤©ç„¶æ¸©æ³‰ ã‚†ã‚‹ã‚Šã®æ¹¯ å¾¡å®¿ çµã®åº„)",
                highlights: ["ç™½å·é„‰åˆæŒæ‘"],
                timeline: [
                    { time: "09:00", action: "å®®å·æœå¸‚/é«˜å±± æ•£ç­–", type: "walk", note: "-" },
                    { time: "12:00", action: "(å¾…ç¢ºèª)åˆé¤ï¼š", type: "food", note: "-" },
                    { time: "14:30", action: "é«˜å±±å·´å£«ç¸½ç«™ -> ç™½å·é„‰å·´å£«ç«™", type: "bus", note: "æ­ä¹˜æ¿ƒé£›å·´å£«ã€‚éœ€äº‹å…ˆé ç´„å·´å£«<br>ç´„ 50 åˆ†é˜è»Šç¨‹" },
                    { time: "15:20", action: "æ¢ç´¢åˆæŒæ‘", type: "walk", note: "åŸå±±å±•æœ›å°ã€å’Œç”°å®¶åƒè§€" },                    
                    { time: "18:00", action: "ç™½å·é„‰å·´å£«ç«™ -> æ—…é¤¨", type: "bus", link: "https://dormy-hotels.com/resort/hotels/shirakawago/access/#lnk_a3", note: "æ­æ¥é§è»Šï¼Œç„¡éœ€é ç´„ã€‚è»Šç¨‹5åˆ†é˜" },
                    { time: "20:00", action: "å®¿ï¼šå¾¡å®¿ çµä¹‹èŠ å¤©ç„¶æ¸©æ³‰ ã‚†ã‚‹ã‚Šã®æ¹¯ å¾¡å®¿ çµã®åº„", type: "rest", link: "https://dormy-hotels.com/resort/hotels/shirakawago/access/#lnk_a3", note: "é™„æ™šã€æ—©é¤" }
                ]
            },
            {
                day: 4,
                date: "5/27 (ä¸‰)",
                title: "ç§»å‹•è‡³å¯Œå±±ï¼Œç»ç’ƒä¹‹åŸ",
                sunset: "19:01",
                stay: "å¯Œå±±ç«™å‘¨é‚Š (å¯Œå±±æ—¥èˆªåŸå¸‚é…’åº— ãƒ›ãƒ†ãƒ«JALã‚·ãƒ†ã‚£å¯Œå±±)",
                highlights: ["å¯Œå±±ç»ç’ƒç¾è¡“é¤¨", "å¯Œå²©é‹æ²³ç’°æ°´å…¬åœ’", "ç™½è¦"],
                note: "â˜…é‡è¦ï¼šä»Šæ™šéœ€å°‡å¤§å‹è¡Œæå¯„è‡³ Day 7 åå¤å±‹é£¯åº—ï¼Œæˆ–æ˜¯ Day 6 ä½å®¿é»(è‹¥ç•¶å¤©èƒ½æ”¶)",
                timeline: [
                    { time: "9:55", action: "æ—…é¤¨ -> ç™½å·é„‰å·´å£«ç«™", type: "bus", note: "æ­æ¥é§è»Šï¼Œç„¡éœ€é ç´„ã€‚è»Šç¨‹5åˆ†é˜" },
                    { time: "10:00", action: "æ¢ç´¢åˆæŒæ‘", type: "walk" },                    
                    { time: "12:00", action: "(å¾…ç¢ºèª)åˆé¤ï¼š", type: "food", link: "https://www.google.com/maps/place/%E9%AE%AE%E9%AD%9A%E9%AD%9A%E5%BB%A3%E3%83%BB%E5%AF%8C%E5%B1%B1%E6%B9%BE%E9%A3%9F%E5%A0%82%E3%83%9E%E3%83%AB%E3%83%BC%E3%83%88%E5%BA%97/@36.7012683,137.2100018,17z/data=!3m1!5s0x5ff7909ce52ba121:0x972b50c45cd42838!4m6!3m5!1s0x5ff7910baaf38083:0xd1b78e2b37c20832!8m2!3d36.7012605!4d137.2112503!16s%2Fg%2F11sq_qg2lt?authuser=0&entry=ttu&g_ep=EgoyMDI2MDEwNy4wIKXMDSoASAFQAw%3D%3D", note: "æµ·é®®éå¸¸æ–°é®®" },
                    { time: "14:10", action: "ç™½å·é„‰å·´å£«ç«™ -> å¯Œå±±å·´å£«ç«™", type: "bus", note: "æ­ä¹˜æ¿ƒé£›å·´å£«ã€‚éœ€äº‹å…ˆé ç´„å·´å£«<br>ç´„ 1å°æ™‚20 åˆ†é˜è»Šç¨‹ï¼Œ15:30æŠµé”å¯Œå±±å·´å£«ç«™" },
                    { time: "15:30", action: "JRå¯Œå±±è»Šç«™ï¼šæ©Ÿå™¨å–ç¥¨ã€ç«‹å±±ç™»å±±çºœè»Šã€‘", type: "ticket", link: "https://tateyama-kurobe-webservice.jp/AlpenTour/html/VW802W0010.html", note: "ã€é›»é‰„å¯Œå±±é§…ã€‘è‡ªå‹•å—å–æ©Ÿãƒ»ç¨¼åƒæ™‚é–“ï¼šåˆå‰ï¼•æ™‚ï¼ï¼åˆ†~åˆå¾Œï¼‘ï¼‘æ™‚ï¼ï¼åˆ†" },
                    { time: "16:00", action: "é£¯åº—check in æˆ– å¯Œå²©é‹æ²³ç’°æ°´å…¬åœ’", type: "walk", link: "https://www.google.com/maps/search/?api=1&query=Fugan+Canal+Kansui+Park", note: "å¯Œå²©é‹æ²³ç’°æ°´å…¬åœ’æœ‰ä¸–ç•Œæœ€ç¾æ˜Ÿå·´å…‹å–å’–å•¡" },                    
                    { time: "17:30", action: "(å¾…ç¢ºèª)æ™šé¤ï¼šå¯Œå±±ç£é£Ÿå ‚ é­šå»£", type: "food", link: "https://www.google.com/maps/place/%E9%AE%AE%E9%AD%9A%E9%AD%9A%E5%BB%A3%E3%83%BB%E5%AF%8C%E5%B1%B1%E6%B9%BE%E9%A3%9F%E5%A0%82%E3%83%9E%E3%83%AB%E3%83%BC%E3%83%88%E5%BA%97/@36.7012683,137.2100018,17z/data=!3m1!5s0x5ff7909ce52ba121:0x972b50c45cd42838!4m6!3m5!1s0x5ff7910baaf38083:0xd1b78e2b37c20832!8m2!3d36.7012605!4d137.2112503!16s%2Fg%2F11sq_qg2lt?authuser=0&entry=ttu&g_ep=EgoyMDI2MDEwNy4wIKXMDSoASAFQAw%3D%3D", note: "æµ·é®®éå¸¸æ–°é®®" },
                    { time: "19:00", action: "å®¿ï¼šå¯Œå±±æ—¥èˆªåŸå¸‚é…’åº— ãƒ›ãƒ†ãƒ«JALã‚·ãƒ†ã‚£å¯Œå±±", type: "hotel", link: "https://www.google.com/maps/place/%E5%AF%8C%E5%B1%B1%E6%97%A5%E8%88%AA%E5%9F%8E%E5%B8%82%E9%85%92%E5%BA%97/@36.7012683,137.2100018,17z/data=!4m10!3m9!1s0x5ff791fcb46d957d:0x29f695e8bf7203ae!5m3!1s2026-05-13!4m1!1i2!8m2!3d36.701136!4d137.2104344!16s%2Fg%2F11q2l8bx2v?authuser=0&entry=ttu&g_ep=EgoyMDI2MDEwNy4wIKXMDSoASAFQAw%3D%3D" }
                ]
            },
            {
                day: 5,
                date: "5/28 (å››)",
                title: "é‡é ­æˆ²ï¼šç«‹å±±é»‘éƒ¨é˜¿çˆ¾å‘æ–¯è·¯ç·š",
                sunset: "18:58",
                stay: "ä¿¡æ¿ƒå¤§ç”º æˆ– æ¾æœ¬ (æ¨è–¦ï¼šæ¾æœ¬ç«™å‘¨é‚Š)",
                highlights: ["é›ªä¹‹å¤§è°·", "é»‘éƒ¨æ°´åº«", "å…­ç¨®äº¤é€šå·¥å…·"],
                note: "â˜…éœ€æ—©èµ·ï¼è«‹ç©¿è‘—é˜²é¢¨ä¿æš–è¡£ç‰©ã€æˆ´å¢¨é¡ã€‚JR Pass å«æ­¤æ®µäº¤é€šã€‚",
                timeline: [
                    { time: "07:30", action: "(å¾…ç¢ºèªè¨‚è³¼åˆ°çš„ç«‹å±±ç™»å±±çºœè»Šæ™‚é–“)JRå¯Œå±±ç«™å–æ•´ç†åˆ¸/æ’éšŠ", type: "ticket", note: "1. å·²ç¶²è·¯è³¼è²· ç«‹å±±ç™»å±±çºœè»Š ã€ç«‹å±±é§… : ç™ºâœç¾å¥³å¹³ :ã€‘ï¼Œä¸éœ€è¦å¤ªæ—©å»æ’éšŠæ‹¿æ•´ç†åˆ¸<br>â€¢ ç¥¨åƒ¹ï¼š1,090 å††/äºº<br>2. ç•¶å¤©æ–¼é›»éµå¯Œå±±ç«™ï¼Œè¨˜å¾—ä»¥å‘¨éŠåˆ¸é ˜å–æ•´ç†åˆ¸<br>3. é›»éµå¯Œå±±ç«™æ­è»Šè‡³ç«‹å±±ç«™ï¼Œç«è»Šç´„éœ€ 1 å°æ™‚" },
                    { time: "10:00", action: "ç«‹å±±è»Šç«™ -> ç¾å¥³å¹³", type: "cablecar", note: "æ­ä¹˜ç™»å±±çºœè»Š" },
                    { time: "10:20", action: "ç¾å¥³å¹³ -> å®¤å ‚ (é›ªä¹‹å¤§è°·)", type: "bus", note: "é«˜åŸå·´å£«(å¤§éƒ¨åˆ†çš„å±±æ™¯éƒ½æ˜¯åœ¨å·¦å´)ï¼Œæ¬£è³é›ªç‰† (5æœˆä¸­é›ªç‰†ä»å£¯è§€)" },
                    { time: "11:10", action: "å®¤å ‚æ•£ç­– & åˆé¤", type: "walk", link: "https://www.google.com/maps/search/?api=1&query=Murodo", note: "åœç•™ç´„ 2-2.5 å°æ™‚ï¼Œæ™¯é»ï¼šé›ªä¹‹å¤§è°·ã€å¾¡åº«è£æ± ã€ç«‹å±±ç‰æ®¿æ¹§æ°´" },
                    { time: "13:45", action: "å®¤å ‚ -> å¤§è§€å³°", type: "bus", note: "ç«‹å±±éš§é“ç„¡è»Œé›»è»Šï¼Œæ™¯é»ï¼šé›ªä¹‹éš§é“" },
                    { time: "14:20", action: "å¤§è§€å³° -> é»‘éƒ¨å¹³", type: "cablecar", note: "ç©ºä¸­çºœè»Šï¼Œæ¨è–¦é»‘éƒ¨å¹³è»Šç«™é ‚æ¨“çš„å±•æœ›å°å¾€å›çœ‹å¤§è§€å³°è»Šç«™" },
                    { time: "15:00", action: "é»‘éƒ¨å¹³ -> é»‘éƒ¨æ¹– -> é»‘éƒ¨æ°´åº«", type: "walk", note: "é»‘éƒ¨ç™»å±±çºœè»Šåˆ°é»‘éƒ¨æ¹–ï¼Œä¹‹å¾Œèµ°åˆ°é»‘éƒ¨æ°´åº«(å£¯è§€çš„æ°´åº«å»ºè¨­)" },
                    { time: "16:05", action: "é»‘éƒ¨æ°´åº« -> æ‰‡æ¾¤", type: "walk", note: "é–¢é›»éš§é“é›»æ°£å·´å£«" },
                    { time: "16:35", action: "æ‰‡æ¾¤ -> ä¿¡æ¿ƒå¤§ç”º", type: "bus", note: "çµæŸç©¿è¶Šè¡Œç¨‹ï¼Œ17:10åˆ°é”ä¿¡æ¿ƒå¤§ç”º" },
                    { time: "18:00", action: "(å¾…ç¢ºèª)å®¿ï¼šä¿¡æ¿ƒå¤§ç”º æˆ– æ¾æœ¬", type: "hotel", note: "å®¿ï¼šä¿¡æ¿ƒå¤§ç”º" }
                ]
            },
            {
                day: 6,
                date: "5/29 (äº”)",
                title: "åœ‹å¯¶æ¾æœ¬åŸï¼Œè¿”å›åå¤å±‹è³¼ç‰©",
                sunset: "19:00",
                stay: "åå¤å±‹è»Šç«™å‘¨é‚Š (åéµæ ¼è˜­é£¯åº— åé‰„ã‚°ãƒ©ãƒ³ãƒ‰ãƒ›ãƒ†ãƒ«è»Šç«™)",
                highlights: ["æ¾æœ¬åŸ", "å¤§é ˆå•†åº—è¡—", "è³¼ç‰©"],
                timeline: [
                    { time: "09:30", action: "æ¾æœ¬åŸ (åœ‹å¯¶äº”åŸ)", type: "history", link: "https://www.google.com/maps/search/?api=1&query=Matsumoto+Castle", note: "é»‘è‰²åŸå ¡éå¸¸ç¨ç‰¹ï¼Œåœ’å€æ•£æ­¥" },
                    { time: "12:00", action: "åˆé¤ï¼šæ¾æœ¬è•éº¥éºµ", type: "food", note: "ä¿¡å·è•éº¥éºµèå" },
                    { time: "13:53", action: "(å¾…ç¢ºèª)æ­ä¹˜ Shinano ç‰¹æ€¥å›åå¤å±‹", type: "train", note: "ç´„ 2 å°æ™‚ï¼Œä½¿ç”¨ JR Pass" },
                    { time: "16:00", action: "(å¾…ç¢ºèª)åå¤å±‹è³¼ç‰©æ™‚é–“", type: "shopping", link: "https://www.google.com/maps/search/?api=1&query=JR+Takashimaya+Nagoya", note: "JR é«˜å³¶å±‹ / Uniqlo / Bic Camera / å¤§åœ‹è—¥å¦" },
                    { time: "19:00", action: "(å¾…ç¢ºèª)è“¬èŠè»’ é°»é­šé£¯", type: "food", link: "https://www.google.com/maps/search/?api=1&query=Atsuta+Horaiken", note: "éœ€æ’éšŠï¼Œå»ºè­°æå‰å»æœ¬åº—æˆ–ç™¾è²¨åº—æŠ½è™Ÿç¢¼ç‰Œ" },
                    { time: "20:00", action: "å®¿ï¼šåéµæ ¼è˜­é£¯åº— åé‰„ã‚°ãƒ©ãƒ³ãƒ‰ãƒ›ãƒ†ãƒ«è»Šç«™", type: "rest", link: "https://www.google.com/maps/place/%E5%90%8D%E9%90%B5%E6%A0%BC%E8%98%AD%E9%A3%AF%E5%BA%97/@35.1684574,136.8818141,17z/data=!3m1!5s0x600376dde7215eeb:0x922749aab9beaa4d!4m10!3m9!1s0x600376dde144a0f7:0xb5a6a966b1810e48!5m3!1s2026-05-13!4m1!1i2!8m2!3d35.168453!4d136.884389!16s%2Fg%2F1tdy_x3y?entry=ttu&g_ep=EgoyMDI2MDEwNi4wIKXMDSoASAFQAw%3D%3D", note: "ç‚ºæ˜å¤©è¡Œç¨‹å„²å‚™é«”åŠ›" }
                ]
            },
            {
                day: 7,
                date: "5/30 (å…­)",
                title: "æ‚ é–’æ—©é¤ï¼Œæ»¿è¼‰è€Œæ­¸",
                sunset: "åˆ°å°ç£æ‹‰~",
                stay: "æº«æš–çš„å®¶",
                highlights: ["ä¸­éƒ¨åœ‹éš›æ©Ÿå ´é€›è¡—", "å›ç¨‹"],
                timeline: [
                    { time: "08:00", action: "æ‚ é–’æ—©é¤ & æœ€å¾Œæ•´ç†", type: "rest", note: "æª¢æŸ¥è­·ç…§èˆ‡æˆ°åˆ©å“" },
                    { time: "09:00", action: "å‰å¾€ä¸­éƒ¨åœ‹éš›æ©Ÿå ´", type: "train", note: "æ­ä¹˜ Î¼-SKY" },
                    { time: "10:00", action: "æ©Ÿå ´é€›è¡— (Flight of Dreams)", type: "shopping", note: "æ©Ÿå ´éå¸¸å¥½é€›ï¼Œæœ‰è¦é¤…å¯è²·" },
                    { time: "12:20", action: "CI 155 èµ·é£›", type: "flight" },
                    { time: "14:30", action: "CI 155 é™è½æ¡ƒåœ’æ©Ÿå ´", type: "flight" }
                ]
            }
        ];

        const foodData = [
            { name: "ã‚ã¤ãŸè“¬è±è»’", type: "nagoya", desc: "åå¤å±‹å¿…åƒé°»é­šé£¯ä¸‰åƒ (Hitsumabushi)ï¼Œæ­·å²æ‚ ä¹…çš„è€åº—ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Atsuta+Horaiken" },
            { name: "çŸ¢å ´ã¨ã‚“", type: "nagoya", desc: "å‘³å™Œè±¬æ’ä»£è¡¨åº—ï¼Œé†¬æ±æ¿ƒéƒï¼Œéå¸¸ä¸‹é£¯ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Yabaton" },
            { name: "ä¸–ç•Œçš„å±±å°‡", type: "nagoya", desc: "å¤¢å¹»æ‰‹ç¾½å…ˆ (ç‚¸é›ç¿…)ï¼Œèƒ¡æ¤’å‘³é‡ï¼Œé©åˆä½œç‚ºå®µå¤œã€‚", map: "https://www.google.com/maps/search/?api=1&query=Sekai+no+Yamachan" },
            { name: "å‘³è—å¤©åœ‹", type: "hida", desc: "é«˜å±±è»Šç«™æ—ï¼ŒJAè¾²å”ç›´ç‡Ÿçš„é£›é©’ç‰›ç‡’è‚‰ï¼ŒCPå€¼æ¥µé«˜ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Ajikura+Tengoku" },
            { name: "å‚å£å±‹", type: "hida", desc: "é«˜å±±è€è¡—å…§ï¼Œé£›é©’ç‰›æ¡å£½å¸æ”¾åœ¨ä»™è²ä¸Šï¼Œé‚Šèµ°é‚Šåƒã€‚", map: "https://www.google.com/maps/search/?api=1&query=Sakaguchiya" },
            { name: "ç™½è¦äº­ (ç™½ãˆã³äº­)", type: "toyama", desc: "ä½æ–¼å¯Œå±±è»Šç«™å…§ï¼Œå¿…é»ç™½è¦å¤©å©¦ç¾…ä¸¼ï¼Œé…¥è„†é®®ç”œã€‚", map: "https://www.google.com/maps/search/?api=1&query=Shiroebitei" },
            { name: "è¥¿èŒ¶å±‹ (Nishi Chaya)", type: "toyama", desc: "å¯Œå±±ç£å£½å¸ï¼Œæ–°é®®ç›´é€çš„æµ·é®®ï¼Œåƒ¹æ ¼åˆç†ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Toyama+Sushi" },
            { name: "Konparu (ã‚³ãƒ³ãƒ‘ãƒ«)", type: "dessert", desc: "åå¤å±‹è€ç‰Œå–«èŒ¶åº—ï¼Œç‚¸è¦ä¸‰æ˜æ²»æ˜¯ç¶“å…¸æ—©é¤ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Konparu+Nagoya" },
            { name: "HARBS æœ¬åº—", type: "dessert", desc: "æºè‡ªåå¤å±‹çš„æ°´æœåƒå±¤è›‹ç³•ï¼ŒSakaeæœ¬åº—é™å®šåˆé–“å¥—é¤ã€‚", map: "https://www.google.com/maps/search/?api=1&query=HARBS+Sakae" },
            { name: "èŒ¶æˆ¿ å¸ƒä¹…åºµ", type: "dessert", desc: "é«˜å±±å¤æ°‘å®¶æ”¹å»ºçš„ç”œé»åº—ï¼Œè•¨é¤…èˆ‡æŠ¹èŒ¶éå¸¸æ£’ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Fukuan+Takayama" }
        ];

        // --- Logic & Render Functions ---

        // Tab Switching
        function switchTab(tabId) {
            // Hide all contents
            document.querySelectorAll('.tab-content').forEach(el => {
                el.classList.add('hidden');
            });
            // Show selected
            document.getElementById(tabId).classList.remove('hidden');
            
            // Update Desktop Buttons
            document.querySelectorAll('nav .nav-btn').forEach(btn => {
                btn.classList.remove('tab-active', 'text-teal-700');
                btn.classList.add('text-gray-500');
                if (btn.getAttribute('onclick').includes(tabId)) {
                    btn.classList.add('tab-active');
                    btn.classList.remove('text-gray-500');
                }
            });

            // Update Mobile Menu visual state (simplified)
            document.getElementById('mobile-menu').classList.add('hidden');
        }

        // Mobile Menu Toggle
        document.getElementById('mobile-menu-btn').addEventListener('click', () => {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        });

        // Icon Helper
        function getIcon(type) {
            const icons = {
                flight: 'âœˆï¸',
                train: 'ğŸš…',
                bus: 'ğŸšŒ',
                hotel: 'ğŸ¨',
                food: 'ğŸ±',
                walk: 'ğŸš¶',
                ticket: 'ğŸ«',
                mountain: 'ğŸ”ï¸',
                cablecar: 'ğŸš ',
                shopping: 'ğŸ›ï¸',
                rest: 'ğŸ›Œ',
                history: 'ğŸ¯',
                art: 'ğŸ¨'
            };
            return icons[type] || 'ğŸ“';
        }

        // Render Itinerary
        function renderItinerary() {
            const container = document.getElementById('timeline-container');
            container.innerHTML = `<div class="timeline-line"></div>`; // Reset and add line

            itineraryData.forEach((day, index) => {
                const dayCard = document.createElement('div');
                dayCard.className = 'relative mb-8 ml-8 group';
                
                // Dot
                const dot = document.createElement('div');
                dot.className = 'absolute -left-10 top-1 w-5 h-5 rounded-full bg-teal-500 border-4 border-white shadow-sm z-10';
                dayCard.appendChild(dot);

                // Content
                let timelineHTML = '';
                day.timeline.forEach(item => {
                    const linkBtn = item.link ? `<a href="${item.link}" target="_blank" class="text-teal-600 hover:text-teal-800 ml-2 text-xs border border-teal-200 px-1 rounded">ğŸ“åœ°åœ–</a>` : '';
                    timelineHTML += `
                        <div class="flex items-start mb-3 last:mb-0">
                            <div class="w-16 flex-shrink-0 text-sm font-bold text-gray-500">${item.time}</div>
                            <div class="flex-grow pb-2 border-b border-gray-100 last:border-0">
                                <div class="text-sm font-semibold text-gray-800">${getIcon(item.type)} ${item.action} ${linkBtn}</div>
                                ${item.note ? `<div class="text-xs text-gray-500 mt-0.5">${item.note}</div>` : ''}
                            </div>
                        </div>
                    `;
                });

                dayCard.innerHTML += `
                    <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow">
                        <div class="bg-gray-50 px-4 py-3 border-b border-gray-200 flex justify-between items-center cursor-pointer" onclick="toggleDay(this)">
                            <div>
                                <span class="text-teal-700 font-bold mr-2">Day ${day.day}</span>
                                <span class="text-gray-600 text-sm font-medium">${day.date}</span>
                                <h3 class="text-lg font-bold text-gray-800 leading-tight mt-1">${day.title}</h3>
                            </div>
                            <div class="text-gray-400 transform transition-transform duration-200">â–¼</div>
                        </div>
                        <div class="p-4 hidden day-details">
                            <div class="mb-3 text-xs bg-yellow-50 text-yellow-800 p-2 rounded">
                                ğŸŒ‡ æ—¥è½æ™‚é–“ï¼š${day.sunset} <br>
                                ğŸ  ä½å®¿ï¼š${day.stay} <br>
                                âœ¨ äº®é»ï¼š${day.highlights.join('ã€')}
                                ${day.note ? `<br>âš ï¸ ${day.note}` : ''}
                            </div>
                            <div>${timelineHTML}</div>
                        </div>
                    </div>
                `;
                container.appendChild(dayCard);
            });
        }

        // Toggle Day Details
        function toggleDay(header) {
            const details = header.nextElementSibling;
            const arrow = header.querySelector('div:last-child');
            
            if (details.classList.contains('hidden')) {
                details.classList.remove('hidden');
                arrow.style.transform = 'rotate(180deg)';
                header.classList.add('bg-teal-50'); // Highlight active
            } else {
                details.classList.add('hidden');
                arrow.style.transform = 'rotate(0deg)';
                header.classList.remove('bg-teal-50');
            }
        }

        // Render Food
        function renderFood(filter = 'all') {
            const grid = document.getElementById('food-grid');
            grid.innerHTML = '';
            
            const filteredData = filter === 'all' ? foodData : foodData.filter(item => item.type === filter);
            
            filteredData.forEach(item => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-lg p-5 shadow-sm border border-gray-200 hover:shadow-md transition';
                
                let tagColor = 'bg-gray-100 text-gray-600';
                let tagText = 'å…¶ä»–';
                if(item.type === 'nagoya') { tagColor = 'bg-orange-100 text-orange-700'; tagText = 'åå¤å±‹'; }
                if(item.type === 'hida') { tagColor = 'bg-red-100 text-red-700'; tagText = 'é«˜å±±/é£›é©’'; }
                if(item.type === 'toyama') { tagColor = 'bg-blue-100 text-blue-700'; tagText = 'å¯Œå±±'; }
                if(item.type === 'dessert') { tagColor = 'bg-pink-100 text-pink-700'; tagText = 'ç”œé»'; }

                card.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-bold text-lg text-gray-800">${item.name}</h3>
                        <span class="${tagColor} text-xs px-2 py-1 rounded-full">${tagText}</span>
                    </div>
                    <p class="text-gray-600 text-sm mb-4 h-10 overflow-hidden">${item.desc}</p>
                    <a href="${item.map}" target="_blank" class="block text-center w-full bg-white border border-teal-500 text-teal-600 py-1.5 rounded text-sm hover:bg-teal-50 transition">
                        ğŸ“ Google Maps å°èˆª
                    </a>
                `;
                grid.appendChild(card);
            });
        }

        // Filter Food Handler
        function filterFood(type) {
            // Update Buttons
            document.querySelectorAll('.food-filter-btn').forEach(btn => {
                const btnType = btn.getAttribute('onclick').split("'")[1];
                if (btnType === type) {
                    btn.className = "food-filter-btn bg-gray-800 text-white px-3 py-1 rounded-full text-sm shadow-md";
                } else {
                    btn.className = "food-filter-btn bg-white border border-gray-300 text-gray-600 px-3 py-1 rounded-full text-sm hover:bg-gray-100";
                }
            });
            renderFood(type);
        }

        // --- [æ—…è²»è¨˜å¸³åŠŸèƒ½ (ä¾†è‡ª finance.html)] ---
        let entries = JSON.parse(localStorage.getItem('trip_v5_data')) || [];
        let editingId = null;

        function handleCreate() {
            const item = document.getElementById('add-item').value.trim();
            const jpy = parseFloat(document.getElementById('add-jpy').value);
            if (!item || isNaN(jpy)) return;
            entries.push({ id: 'exp-' + Date.now(), day: parseInt(document.getElementById('add-day').value), cat: document.getElementById('add-cat').value, item, jpy, twd: null });
            syncAndRender();
            document.getElementById('add-item').value = ''; document.getElementById('add-jpy').value = '';
        }

        function renderFinanceList() {
            const target = document.getElementById('render-target');
            target.innerHTML = '';
            let totalTWD = 0;
            for (let d = 1; d <= 8; d++) {
                const dayItems = entries.filter(e => e.day === d);
                if (dayItems.length === 0) continue;
                const dayTwdTotal = dayItems.reduce((acc, curr) => acc + (curr.twd || 0), 0);
                totalTWD += dayTwdTotal;
                const section = document.createElement('div');
                section.innerHTML = `
                    <div class="flex justify-between text-xs font-bold text-gray-400 mb-2 px-1"><span>DAY ${d}</span><span>NT$ ${dayTwdTotal.toLocaleString()}</span></div>
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-50 divide-y divide-gray-50 overflow-hidden">
                        ${dayItems.map(i => `<div onclick="openEditModal('${i.id}')" class="p-4 flex justify-between items-center tap-active cursor-pointer">
                            <div class="flex items-center gap-3"><span>${i.cat}</span><div><p class="text-sm font-bold text-gray-800">${i.item}</p><p class="text-[10px] text-gray-400 font-mono">Â¥${i.jpy.toLocaleString()}</p></div></div>
                            <div class="text-right">${i.twd ? `<p class="text-sm font-black text-gray-700">NT$ ${i.twd.toLocaleString()}</p>` : `<span class="text-[9px] text-red-400 font-bold bg-red-50 px-2 rounded-md">å¾…å¡«</span>`}</div>
                        </div>`).join('')}
                    </div>`;
                target.appendChild(section);
            }
            document.getElementById('top-total-twd').innerText = 'NT$ ' + totalTWD.toLocaleString();
        }

        function syncAndRender() { localStorage.setItem('trip_v5_data', JSON.stringify(entries)); renderFinanceList(); }
        function openEditModal(id) { editingId = id; const e = entries.find(x => x.id === id); document.getElementById('edit-item').value = e.item; document.getElementById('edit-jpy').value = e.jpy; document.getElementById('edit-twd').value = e.twd || ''; document.getElementById('modal-edit').classList.remove('hidden'); }
        function closeModals() { document.getElementById('modal-edit').classList.add('hidden'); document.getElementById('modal-delete').classList.add('hidden'); }
        function saveChanges() { const idx = entries.findIndex(e => e.id === editingId); if (idx !== -1) { entries[idx].item = document.getElementById('edit-item').value.trim(); entries[idx].jpy = parseFloat(document.getElementById('edit-jpy').value) || 0; entries[idx].twd = document.getElementById('edit-twd').value ? parseFloat(document.getElementById('edit-twd').value) : null; syncAndRender(); closeModals(); } }
        function showDeleteConfirm() { document.getElementById('modal-delete').classList.remove('hidden'); }
        function hideDeleteConfirm() { document.getElementById('modal-delete').classList.add('hidden'); }
        function executeDelete() { entries = entries.filter(e => e.id !== editingId); syncAndRender(); closeModals(); }

        // Initialize Charts
        function initCharts() {            

            // Budget Chart
            const ctxBudget = document.getElementById('budgetChart').getContext('2d');
            new Chart(ctxBudget, {
                type: 'doughnut',
                data: {
                    labels: ['æ©Ÿç¥¨', 'ä½å®¿', 'äº¤é€š', 'é¤é£²é–€ç¥¨'],
                    datasets: [{
                        data: [18000, 21000, 6500, 14000],
                        backgroundColor: ['#A78BFA', '#FBCFE8', '#99F6E4', '#FDE68A'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
        }

        // Initialize App
        document.addEventListener('DOMContentLoaded', () => {
            renderItinerary();
            renderFood();
            initCharts();
            renderFinanceList();
            // Default active
            document.querySelector('[onclick="switchTab(\'itinerary\')"]').classList.add('tab-active');
            
            // Expand Day 1 by default
            const firstDay = document.querySelector('.timeline-line').nextElementSibling;
            if(firstDay) toggleDay(firstDay.querySelector('.bg-gray-50'));
        });

    </script>
</body>

</html>











